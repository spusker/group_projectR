---
title: "group_project"
author: "Stephanie Pusker"
date: "2022-11-16"
output: 
  flexdashboard::flex_dashboard:
     storyboard: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, error = FALSE)
```

```{r, include = FALSE}
library(flexdashboard)
library(readr)
library(lubridate)
library(shiny)
library(jsonlite)
library(maptools)
library(ggplot2)
library(tidyr)
library(dplyr)
library(purrr)
library(leaflet)
library(plotly)
library(DT)
library(ggthemes)
library(viridis)
library(tidyverse)
library(tigris)


nyc_squirrels <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-29/nyc_squirrels.csv")

nyc_squirrels_clean <- nyc_squirrels %>% 
  select(long, lat, unique_squirrel_id, hectare, date, hectare_squirrel_number,
         age, primary_fur_color, highlight_fur_color, running, chasing,
         climbing, eating, foraging, kuks, quaas, moans, tail_flags,
         tail_twitches, indifferent, runs_from, community_districts,
         police_precincts) %>% 
  mutate(date = mdy(date)) %>% 
  na.omit()

```


### Interactive Map

```{r, map with tigris}

# leaflet map for central park
leaflet() %>% 
  addTiles() %>% 
  fitBounds(-73.9823592,40.7636484,-73.9492441, 40.8005539)%>%
  


  

 
```


### Table 

```{r, table}

## Table 1

df_table <- nyc_squirrels_clean %>% 
  select(running, chasing,climbing, eating, foraging, kuks, quaas, moans, tail_flags, tail_twitches, indifferent, runs_from)

df_table_2 <- df_table %>%
  as.data.frame() %>% 
  pivot_longer(names_to = "activity", values_to = "true_false")

fur_color_activity <- nyc_squirrels_clean %>%
  select(primary_fur_color, running)
  group_by(primary_fur_color) %>% 
  summarize(count = n())

running <- nyc_squirrels_clean %>%
  group_by(running) %>% 
  summarize(count = n()) %>% 
  ungroup() %>% 
  group_by(chasing) %>% 
  summarize(count = n())
  
chasing <- nyc_squirrels_clean %>%
  group_by(chasing) %>% 
  summarize(count = n())

climbing <- nyc_squirrels_clean %>%
  group_by(climbing) %>% 
  summarize(count = n())

eating <- nyc_squirrels_clean %>%
  group_by(eating) %>% 
  summarize(count = n())

kuks <- nyc_squirrels_clean %>%
  group_by(kuks) %>% 
  summarize(count = n())

quaas <- nyc_squirrels_clean %>%
  group_by(quaas) %>% 
  summarize(count = n())

moans <- nyc_squirrels_clean %>%
  group_by(moans) %>% 
  summarize(count = n())

tail_flags <- nyc_squirrels_clean %>%
  group_by(tail_flags) %>% 
  summarize(count = n())

tail_twitches <- nyc_squirrels_clean %>%
  group_by(tail_twitches) %>% 
  summarize(count = n())

indifferent <- nyc_squirrels_clean %>%
  group_by(indifferent) %>% 
  summarize(count = n())

runs_from <- nyc_squirrels_clean %>%
  group_by(runs_from) %>% 
  summarize(count = n())

```

### Plot

```{r, table 2}
nyc_squirrels_clean_test <- nyc_squirrels_clean %>%
  mutate(label = primary_fur_color)%>%
  mutate(label = fct_recode(label,
                            "https://inaturalist-open-data.s3.amazonaws.com/photos/176023507/original.jpeg" = "Gray",
                            "https://cms.prod.nypr.digital/images/329566/fill-1200x800%7Cformat-jpeg%7Cjpegquality-85" = "Black",
                            "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQub0O9b_HAjJjvFaz-w_d9sE6hsJLcRjadJfipfXv5udR5hPsKjsFcgXiKtxohSpQXB8I&usqp=CAU" = "Cinnamon"))


fur_color <- colorFactor(c("Black","Brown","Gray"),
                               domain = nyc_squirrels_clean$primary_fur_color)

 leaflet() %>% 
  addTiles() %>% 
  fitBounds(-73.9823592,40.7636484,-73.9492441, 40.8005539)%>%
  addTiles() %>% 
  addCircleMarkers(nyc_squirrels_clean$long, 
                   nyc_squirrels_clean$lat, 
                   color = fur_color(nyc_squirrels_clean$primary_fur_color), 
                   radius = 0.5, 
                   fill = T,
                   fillOpacity = 0.5,
                   opacity = 1,
                   popup = 
               paste('<img src="', nyc_squirrels_clean_test$label, '" alt="these be unis" width="75"><br>',
                     "<b>ID:</b>",nyc_squirrels_clean$unique_squirrel_id,"<br/>",
                     "<b>Color:</b>",nyc_squirrels_clean$primary_fur_color,"<br/>"))%>%
   addLegend("bottomright", pal = fur_color,
                         values = nyc_squirrels_clean$primary_fur_color,
                         title = "Primary fur color")
                   
    





```

